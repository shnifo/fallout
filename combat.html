<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>5x5 Weighted Grid Generator</title>
<style>
  body {
    background-color: #1e1e1e;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 0;
    padding: 10px;
  }
  h1 {
    margin-bottom: 10px;
    font-size: 1.3em;
  }
  .controls {
    display: inline-block;
    background-color: #2b2b2b;
    padding: 8px;
    border-radius: 10px;
    margin-bottom: 10px;
    width: 95%;
    max-width: 400px;
  }
  .controls label {
    display: flex;
    justify-content: space-between;
    margin: 3px 0;
    font-size: 0.9em;
  }
  .controls input {
    width: 50px;
    text-align: right;
  }
  #grid {
    display: grid;
    grid-template-columns: 12% repeat(5, 1fr);
    gap: 2px;
    justify-items: center;
    width: 100%;
    max-width: 100vw;
    margin: 0 auto;
  }
  .tile {
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    border-radius: 6px;
    color: white;
    width: 100%;
    aspect-ratio: 1/1;
    font-size: 4vw;
    user-select: none;
  }
  .label {
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 3vw;
    color: #ddd;
    width: 100%;
    aspect-ratio: 1/1;
  }
  button {
    background-color: #444;
    color: white;
    border: none;
    padding: 8px 12px;
    font-size: 1em;
    margin-top: 6px;
    border-radius: 6px;
    cursor: pointer;
  }
  button:hover {
    background-color: #666;
  }
  @media (min-width: 500px) {
    .tile { font-size: 2em; }
    .label { font-size: 1em; }
    .controls label { font-size: 1em; }
    .controls input { width: 60px; }
  }
</style>
</head>
<body>

<h1>5x5 Weighted Grid Generator</h1>

<div class="controls">
  <h3>Tile Weighting</h3>
  <label>üí£ Explosive: <input type="number" id="explosive" value="1" step="0.1"></label>
  <label>üß± Cover: <input type="number" id="cover" value="1" step="0.1"></label>
  <label>ü™® Ruins: <input type="number" id="ruins" value="1" step="0.1"></label>
  <label>‚ùå Impassible: <input type="number" id="impassible" value="1" step="0.1"></label>
  <label>‚≠ê Special: <input type="number" id="special" value="2" step="0.1"></label>
  <label>‚¨õ Blank: <input type="number" id="blank" value="5" step="0.1"></label>
  <button id="generate" onclick="generateGrid()">Generate Grid</button>
</div>
<div style="display:flex; justify-content:center; gap:8px; margin-top:4px;">
  <label>Party Level: <input id="partyLevel" type="number" value="5" min="1" style="width:50px;"></label>
  <label>Players: <input id="numPlayers" type="number" value="3" min="1" style="width:50px;"></label>
</div>


<h3 id="zone-display" style="text-align:center; margin-bottom:8px;">Zone: ‚Äî</h3>
<h3 id="monster-display" style="text-align:center; margin-bottom:8px;">Monsters: ‚Äî</h3>


<div id="grid"></div>

<script>
  const tileTypes = [
    { name: "Explosive", symbol: "üí£", color: "#e25822" },
    { name: "Cover", symbol: "üß±", color: "#888888" },
    { name: "Ruins", symbol: "ü™®", color: "#6b4f3a" },
    { name: "Impassible", symbol: "‚ùå", color: "#4a148c" },
    { name: "Special", symbol: "‚≠ê", color: "#e6c200" },
    { name: "Blank", symbol: "", color: "#2b2b2b" }
  ];

  const rowLabels = ["A","B","C","D","E"];
  const colLabels = ["1","2","3","4","5"];

  function generateGrid() {
    const weights = [
      parseFloat(document.getElementById("explosive").value),
      parseFloat(document.getElementById("cover").value),
      parseFloat(document.getElementById("ruins").value),
      parseFloat(document.getElementById("impassible").value),
      parseFloat(document.getElementById("special").value),
      parseFloat(document.getElementById("blank").value)
    ];

    const totalWeight = weights.reduce((a, b) => a + b, 0);
    const probabilities = weights.map(w => w / totalWeight);

    const gridContainer = document.getElementById("grid");
    gridContainer.innerHTML = "";

    // Top-left corner
    const corner = document.createElement("div");
    corner.className = "label";
    gridContainer.appendChild(corner);

    // Column labels
    for (let c = 0; c < colLabels.length; c++) {
      const colLabel = document.createElement("div");
      colLabel.className = "label";
      colLabel.textContent = colLabels[c];
      gridContainer.appendChild(colLabel);
    }

    // Rows and tiles
    for (let r = 0; r < 5; r++) {
      // Row label
      const rowLabel = document.createElement("div");
      rowLabel.className = "label";
      rowLabel.textContent = rowLabels[r];
      gridContainer.appendChild(rowLabel);

      for (let c = 0; c < 5; c++) {
        const tileType = weightedRandom(tileTypes, probabilities);
        const tile = document.createElement("div");
        tile.className = "tile";
        tile.style.backgroundColor = tileType.color;
        tile.textContent = tileType.symbol;
        gridContainer.appendChild(tile);
      }
    }
  }

  function weightedRandom(items, probabilities) {
    let r = Math.random();
    let sum = 0;
    for (let i = 0; i < items.length; i++) {
      sum += probabilities[i];
      if (r <= sum) return items[i];
    }
    return items[items.length - 1];
  }

  generateGrid();
  // === Zone Table Data ===
const zoneTable = {
  11: "Office: Contains 2 Vending machines with 1d6 Nuka Cola / Sunset Sarsaparilla for 10c each. Autojacker to open.",
  12: "Department Store: Scavenged stackables give +1 yield. Use Flashlight to add +2 to scavenge roll.",
  13: "Bunker: Scavenged items have +1 durability. Use Breatherator to add +2 to scavenge roll.",
  14: "Graveyard: -1 enemy. Use Hammerator to add +2 to scavenge roll.",
  15: "Condominium: Refresh all skill/luck/resist when sleeping here.",
  16: "Factory: Contains a random tech, or fully repairs the same tech if you already have it.",

  21: "Museum: Contains 1 artifact. Use Hackerator for heavy relic worth 1d6√ó100c.",
  22: "Prison: +1 enemy. Contains a random military equipment item.",
  23: "Park: Contains a random potted plant. Plants grown here give +100% yield if left for one level.",
  24: "Railyard: Contains 1d3 flares (10c). Flares reduce enemies by 1 in Ruins.",
  25: "Library: Order a random recipe that arrives on level up. Use Hackerator to order another.",
  26: "Warehouse: Ship your items to any hex; they arrive on level up.",

  31: "Casino: Contains a slot machine. Spend 40c to roll 1d6√ó10c. Crit = 120c jackpot, 1 = break.",
  32: "Laundromat: Spend 50c to reroll armor values.",
  33: "Workshop: Has a workbench; repairing items costs 1 less scrap.",
  34: "Missile Silo: Spend 10 tech scrap to fire a missile at any hex (30 explosive damage).",
  35: "Armory: Spend 10 gun scrap to upgrade a weapon with +1 damage.",
  36: "Bank: Deposit caps, gain 20% on level up. Withdraw at any bank.",

  41: "Military Base: Scavenging weapons/armor here gives +1 to rolls.",
  42: "Farm: Contains brahmin. CHA 1d6 milk (-1 thirst, -1 rad, 20c) or AGI 1d6 flesh (-1 hunger, +20% HP, 20c). Crit: 3√ó yield.",
  43: "Quarry: Use explosives to excavate gemstones worth 1d6√ó50c (bulky).",
  44: "Crash Site: Contains a mutator that transforms a weapon into its mutated form.",
  45: "Campsite: Can scavenge for 1d3 flares. Crit: find 2√ó.",
  46: "Foundry: Spend 10 armor scrap to add +1 to all defense values of an armor.",

  51: "Interchange: Generates any faction‚Äôs settlement 3 hexes away.",
  52: "Laboratory: Generates a Ruins from 5 choices 3 hexes away.",
  53: "Airport: Generates an adjacent Subway. Contains 1 flare for each Subway.",
  54: "Resort: Generates adjacent irradiated lake island (+3 to scavenging).",
  55: "Subway: Generates another Subway 5 hexes away. You can fast travel between cleared Subways.",
  56: "Stadium: Contains a wandering duelist that will 1v1 for a random loot prize.",

  61: "Hospital: When you heal or remove a status, heal +10% or remove 1 extra.",
  62: "Restaurant: Can order food (1d6+10 rations) that arrives on level up.",
  63: "Hotel: Sleeping here grants 'Well Rested'.",
  64: "Junkyard: Has a workbench. Scrapping gives +1 scrap.",
  65: "Supermarket: Scavenging food/water gives +1 to rolls and yield.",
  66: "Church: No battle. Friendly merchant with 2 bodyguards trades and has random + crit loot."
};

// === Zone Generator Function ===
function generateZone() {
  const d1 = Math.floor(Math.random() * 6) + 1;
  const d2 = Math.floor(Math.random() * 6) + 1;
  const roll = d1 * 10 + d2;
  const zone = zoneTable[roll] || "Unknown Zone";
  document.getElementById("zone-display").textContent = `${zone}`;
}
// === Monster Categories ===
const monsterData = {
  E1: { label: "Raiders", notes: "on terrain 4-5, hidden land mines. Loot: broken weapons & armor, mines, human flesh", subs: [
    { name: "Scout", hp: 10, notes: "tier1 weapons, 10x mines" },          // 1-6
    { name: "Tweaker", hp: 13, notes: "tier2 weapons, 11x mines" },        // 7-8
    { name: "Scavenger", hp: 16, notes: "tier3 weapons, 12x mines" },      // 9-10
    { name: "Juicer", hp: 19, notes: "tier4 weapons, 13x mines" },         // 11-12
    { name: "Elite", hp: 22, notes: "tier5 weapons, 14x mines" },          // 13-14
    { name: "Chemlord", hp: 25, notes: "tier6 weapons, 15x mines" }        // 15+
  ]},

  E2: { label: "Beasts", notes: "on death: allies can immediately attack. Loot: animal flesh", subs: [
    { name: "Bloatfly", hp: 6, notes: "5 R short thrown" },
    { name: "Wild Dog", hp: 10, notes: "8 P melee, grapples on 6" },
    { name: "Radstag", hp: 14, notes: "10 P melee, shove on 6, +1 spd, +2 dmg on sprint" },
    { name: "Yao Guai", hp: 18, notes: "2x9 P melee, +1 spd, shove on 6" },
    { name: "Deathclaw", hp: 22, notes: "2x11 P melee + bleed, +1 spd" },
    { name: "Radragon", hp: 26, notes: "12 X+R splash + poison + burn, mid line, -1 mob" }
  ]},

  E3: { label: "Nesters", notes: "terrain 4-5: eggs hatch into swarmers. Loot: animal flesh", subs: [
    { name: "Gecko", hp: 9, notes: "6 P + bleed melee" },
    { name: "Mirelurk", hp: 12, notes: "7 P melee, 2x armor, aim head ignores armor" },
    { name: "Fire Gecko", hp: 15, notes: "8 X + burn, short" },
    { name: "Lakelurk", hp: 18, notes: "9 E + disorient, mid" },
    { name: "Cazadores", hp: 21, notes: "10 P melee + poison, fly, +1 spd" },
    { name: "Nightstalker", hp: 24, notes: "2x9 P melee + poison + bleed" }
  ]},

  E4: { label: "Burrowers", notes: "terrain 4-5: hidden tunnel. Loot: animal flesh", subs: [
    { name: "Radroach", hp: 8, notes: "7 P melee" },
    { name: "Molerat", hp: 11, notes: "2x6 P melee, +1 spd" },
    { name: "Radscorpion", hp: 14, notes: "10 P melee + poison" },
    { name: "Fire Ant", hp: 17, notes: "11 X splash + burn, short" },
    { name: "Gulper", hp: 20, notes: "2x9 P + grapple, +1 spd" },
    { name: "Tunneler", hp: 23, notes: "13 P melee + poison + grapples on 6" }
  ]},

  E5: { label: "Robots", notes: "explode at death for 50% HP X splash. Loot: tech scraps", subs: [
    { name: "Protectron", hp: 11, notes: "8 E melee" },
    { name: "Cyberdog", hp: 14, notes: "9 P melee, +1 spd" },
    { name: "Robobrain", hp: 17, notes: "10 E + disorient, short" },
    { name: "Securitron", hp: 20, notes: "11 X long" },
    { name: "Sentry Bot", hp: 23, notes: "3x9 P mid" },
    { name: "Assaultron", hp: 26, notes: "14 E+R melee, charge 1, +1 spd" }
  ]},

  E6: { label: "Synths", notes: "terrain 4-5: hidden pulse mines. Loot: armor scrap", subs: [
    { name: "Scout", hp: 11, notes: "tier1 energy weapons + 10E mines" },
    { name: "Patroller", hp: 14, notes: "tier2 energy weapons + 11E mines" },
    { name: "Trooper", hp: 17, notes: "tier3 energy weapons + 12E mines" },
    { name: "Eradicator", hp: 20, notes: "tier4 energy weapons +13E mines" },
    { name: "Assassin", hp: 23, notes: "tier5 energy weapons +14E mines" },
    { name: "Courser", hp: 26, notes: "tier6 energy weapons +15E mines" }
  ]},

  O1: { label: "Cultist", notes: "‚Öì to use random artifact, mutated weapons. Loot: broken weapons, human flesh", subs: [
    { name: "Initiate", hp: 10, notes: "tier1 weapons" },
    { name: "Acolyte", hp: 13, notes: "tier2 weapons" },
    { name: "Disciple", hp: 16, notes: "tier3 weapons" },
    { name: "Priest", hp: 19, notes: "tier4 weapons" },
    { name: "Fanatic", hp: 22, notes: "tier5 weapons" },
    { name: "Leader", hp: 25, notes: "tier6 weapons" }
  ]},

  O2: { label: "Hoverbots", notes: "all hover; gain shield when ally dies. Loot: gun scraps", subs: [
    { name: "Eyebot", hp: 9, notes: "2x4 E, mid" },
    { name: "Mr. Handy", hp: 12, notes: "2x6 P, mid" },
    { name: "Battle Drone", hp: 15, notes: "3x6 X, short" },
    { name: "Mr. Gutsy", hp: 18, notes: "10 X splash, mid" },
    { name: "Think Tank", hp: 21, notes: "2x9 E + disorient, mid" },
    { name: "UFO", hp: 24, notes: "2x10 R splash+burn, mid, +1 spd" }
  ]},

  O3: { label: "Feral Ghouls", notes: "Xrad, +1 spd, +1 mob. Loot: mutant flesh, ¬Ω junk item", subs: [
    { name: "Roamer", hp: 7, notes: "2x5 P melee, grapples on 6" },
    { name: "Stalker", hp: 10, notes: "2x7 P melee, grapples on 6" },
    { name: "Glowing One", hp: 13, notes: "9 R splash, melee" },
    { name: "Reaver", hp: 16, notes: "2x9 P melee, grapples on 6" },
    { name: "Molten One", hp: 19, notes: "14 X splash+burn, short, aim" },
    { name: "Frozen One", hp: 22, notes: "18 E splash+disorient, short, aim" }
  ]},

  O4: { label: "Aberrations", notes: "Xrad, half to gain rad on entry. Loot: mutant flesh", subs: [
    { name: "Mutant Plant", hp: 6, notes: "7 P melee, immobile" },
    { name: "Centaur", hp: 10, notes: "8 R, short" },
    { name: "Floater", hp: 14, notes: "9 P, melee, hover, +1 spd" },
    { name: "Putrid Bloat", hp: 18, notes: "10 P melee, explodes 12R short splash on death" },
    { name: "Wanamingo", hp: 22, notes: "11 P+R+psn melee, +1 spd" },
    { name: "Cybermutant", hp: 26, notes: "12 E + random ailment, long, immobile, -1 mob" }
  ]},

  O5: { label: "Super Mutants", notes: "immune to rad, heavy weapons only, 1 suicider. Loot: broken weapons, mutant flesh", subs: [
    { name: "Skirmisher", hp: 12, notes: "tier1 weapons, 16 X splash melee suicider" },
    { name: "Brute", hp: 15, notes: "tier2 weapons, 17 X splash melee suicider" },
    { name: "Enforcer", hp: 18, notes: "tier3 weapons, 18 X splash melee suicider" },
    { name: "Leader", hp: 21, notes: "tier4 weapons, 19 X splash melee suicider" },
    { name: "Overlord", hp: 24, notes: "tier5 weapons, 20 X splash melee suicider" },
    { name: "Mastermind", hp: 27, notes: "tier6 weapons, 21 X splash melee suicider" }
  ]},

  O6: { label: "Nightkin", notes: "immune to rad, ¬Ω to be stealthed with 1D stealth boy. Loot: mutant flesh, ‚Öì 1D stealth boy", subs: [
    { name: "Skirmisher", hp: 12, notes: "8 P melee" },
    { name: "Brute", hp: 15, notes: "tier7x2 P melee" },
    { name: "Enforcer", hp: 18, notes: "10 P melee" },
    { name: "Leader", hp: 21, notes: "8x2 P melee" },
    { name: "Overlord", hp: 24, notes: "11 P melee" },
    { name: "Mastermind", hp: 27, notes: "9x2 P melee" }
  ]}
};
// === Helper: map tierRoll to tier index (0..5) and a human-range label ===
function tierIndexFromRoll(tierRoll) {
  if (tierRoll <= 6) return { idx: 0, label: "1 (1-6)" };
  if (tierRoll <= 8) return { idx: 1, label: "2 (7-8)" };
  if (tierRoll <= 10) return { idx: 2, label: "3 (9-10)" };
  if (tierRoll <= 12) return { idx: 3, label: "4 (11-12)" };
  if (tierRoll <= 14) return { idx: 4, label: "5 (13-14)" };
  return { idx: 5, label: "6 (15+)" };
}
// === Monster Generator ===
function generateMonsters() {
  const level = Math.max(1, parseInt(document.getElementById("partyLevel").value) || 1);
  const players = Math.max(1, parseInt(document.getElementById("numPlayers").value) || 1);

  // Category selection (2d6: d1 even/odd -> prefix, d2 -> category number)
  const d1 = Math.floor(Math.random() * 6) + 1;
  const d2 = Math.floor(Math.random() * 6) + 1;
  const prefix = (d1 % 2 === 0) ? "O" : "E";
  const catKey = `${prefix}${d2}`;
  const cat = monsterData[catKey] || { label: "Unknown", subs: [] };

  // Number of enemies: roll 1d6 per player and sum
const counts = [];
for (let i = 0; i < players; i++) {
  const roll = Math.floor(Math.random() * 6) + 1; // 1‚Äì6
  if (roll === 1) counts.push(0);      // 0 enemies
  else if (roll >= 2 && roll <= 4) counts.push(1); // 1 enemy
  else counts.push(2);                 // 5‚Äì6 = 2 enemies
}
const totalEnemies = counts.reduce((a, b) => a + b, 0);


  // Tier roll: 1d6 + party level
  const tierRoll = Math.floor(Math.random() * 6) + 1 + level;
  const tierInfo = tierIndexFromRoll(tierRoll);
  const tierIdx = tierInfo.idx;

  // Pick subtype for the tier
  const subtype = (cat.subs && cat.subs[tierIdx]) ? cat.subs[tierIdx] : { name: "Unknown", hp: "?", notes: "" };

  // Build a readable string
  const summaryLines = [];
  summaryLines.push(`${cat.label} ‚Äî ${cat.notes || ""}`);
  summaryLines.push(`${totalEnemies}x ${subtype.name} (${subtype.hp} HP)`);
  if (subtype.notes) summaryLines.push(`${subtype.notes}`);

  // Write to UI
  const out = summaryLines.join(" ¬∑ ");
  const md = document.getElementById("monster-display");
  if (md) md.textContent = out;
}

// Modify your existing ‚ÄúGenerate Map‚Äù button click logic to also call this:
document.getElementById("generate").addEventListener("click", () => {
  generateGrid();
  generateZone();
  generateMonsters();
});

</script>

</body>
</html>

